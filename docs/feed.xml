<?xml version="1.0" encoding="utf-8"?><feed xmlns="http://www.w3.org/2005/Atom" xml:lang="zh"><generator uri="https://jekyllrb.com/" version="3.6.3">Jekyll</generator><link href="http://localhost:4000/feed.xml" rel="self" type="application/atom+xml" /><link href="http://localhost:4000/" rel="alternate" type="text/html" hreflang="zh" /><updated>2019-10-13T22:32:30-07:00</updated><id>http://localhost:4000/</id><title type="html">用中文编程</title><subtitle>尽量用中文编写代码. 包括中文命名, 汉化库, 汉化关键词, 新创中文语法的编程语言等等. Program in Chinese wherever possible. Including using Chinese naming in code, making API in Chinese, supporting Chinese keywords in existing programming languages, and creating new programming languages with Chinese grammar.</subtitle><entry><title type="html">(多图)火热出炉的大疆机甲大师教育机器人开箱组装小记</title><link href="http://localhost:4000/%E6%9C%BA%E7%94%B2%E5%A4%A7%E5%B8%88/2019/10/11/(%E5%A4%9A%E5%9B%BE)%E7%81%AB%E7%83%AD%E5%87%BA%E7%82%89%E7%9A%84%E5%A4%A7%E7%96%86%E6%9C%BA%E7%94%B2%E5%A4%A7%E5%B8%88%E5%BC%80%E7%AE%B1%E5%AE%89%E8%A3%85%E5%B0%8F%E8%AE%B0.html" rel="alternate" type="text/html" title="(多图)火热出炉的大疆机甲大师教育机器人开箱组装小记" /><published>2019-10-11T00:00:00-07:00</published><updated>2019-10-11T00:00:00-07:00</updated><id>http://localhost:4000/%E6%9C%BA%E7%94%B2%E5%A4%A7%E5%B8%88/2019/10/11/(%E5%A4%9A%E5%9B%BE)%E7%81%AB%E7%83%AD%E5%87%BA%E7%82%89%E7%9A%84%E5%A4%A7%E7%96%86%E6%9C%BA%E7%94%B2%E5%A4%A7%E5%B8%88%E5%BC%80%E7%AE%B1%E5%AE%89%E8%A3%85%E5%B0%8F%E8%AE%B0</id><content type="html" xml:base="http://localhost:4000/%E6%9C%BA%E7%94%B2%E5%A4%A7%E5%B8%88/2019/10/11/(%E5%A4%9A%E5%9B%BE)%E7%81%AB%E7%83%AD%E5%87%BA%E7%82%89%E7%9A%84%E5%A4%A7%E7%96%86%E6%9C%BA%E7%94%B2%E5%A4%A7%E5%B8%88%E5%BC%80%E7%AE%B1%E5%AE%89%E8%A3%85%E5%B0%8F%E8%AE%B0.html">&lt;p&gt;2010年之后再没碰过机器人的准新手在向大疆官方确认过Python开发支持使用中文命名标识符之后(应该是独一无二的理由吧), 终于下决心入手.&lt;/p&gt;

&lt;p&gt;昨日(现在半夜1点多, 趁还记得清来复盘)周五中午12点半, 如期等到门铃. 今天的快递大妈看起来分外和蔼啊. 抱进来先…清二十分钟地板…再照箱子:&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;http://localhost:4000/assets/2019-10-11_robomaster%E5%AE%89%E8%A3%851.jpg&quot; alt=&quot;2019-10-11_robomaster安装1&quot; /&gt;&lt;/p&gt;

&lt;p&gt;拆开(废话), 裹得挺严实:&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;http://localhost:4000/assets/2019-10-11_robomaster%E5%AE%89%E8%A3%852.jpg&quot; alt=&quot;2019-10-11_robomaster安装2&quot; /&gt;&lt;/p&gt;

&lt;p&gt;挖到宝了!&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;http://localhost:4000/assets/2019-10-11_robomaster%E5%AE%89%E8%A3%853.jpg&quot; alt=&quot;2019-10-11_robomaster安装3&quot; /&gt;&lt;/p&gt;

&lt;p&gt;挖出来冷静下, 破箱而入前来一张:&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;http://localhost:4000/assets/2019-10-11_robomaster%E5%AE%89%E8%A3%854.jpg&quot; alt=&quot;2019-10-11_robomaster安装4&quot; /&gt;&lt;/p&gt;

&lt;p&gt;这才一点钟, 5点去日托之前还有4个小时, 大概..应该够了吧. 开工!&lt;/p&gt;

&lt;p&gt;之前看到官网上摆出来的零件一大片, 先准备好~&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;http://localhost:4000/assets/2019-10-11_robomaster%E5%AE%89%E8%A3%855.jpg&quot; alt=&quot;2019-10-11_robomaster安装5&quot; /&gt;&lt;/p&gt;

&lt;p&gt;第一层. 盒子里大概是说明书吧~~并不是! 看了一眼像是视觉训练用的卡片, 嗯…有点想要说明书. 轮子用的小零件排的挺齐哈.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;http://localhost:4000/assets/2019-10-11_robomaster%E5%AE%89%E8%A3%856.jpg&quot; alt=&quot;2019-10-11_robomaster安装6&quot; /&gt;&lt;/p&gt;

&lt;p&gt;第二层, 哦豁有点”机器人”的感觉了有没有.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;http://localhost:4000/assets/2019-10-11_robomaster%E5%AE%89%E8%A3%857.jpg&quot; alt=&quot;2019-10-11_robomaster安装7&quot; /&gt;&lt;/p&gt;

&lt;p&gt;三层都拿出来, 虽然好几个零件还不明觉厉, 至少包装很专业的样子.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;http://localhost:4000/assets/2019-10-11_robomaster%E5%AE%89%E8%A3%858.jpg&quot; alt=&quot;2019-10-11_robomaster安装8&quot; /&gt;&lt;/p&gt;

&lt;p&gt;到底了?? 还是没有说明书? 找手机app里的文档, 打开了”How to Assemble RoboMaster S1”官方安装教学视频, 终于有了点底. 才12分钟多的视频, 为啥印象里说安装耗时从两个半到四个小时呢?&lt;/p&gt;

&lt;p&gt;既然有护目镜, 最好戴一下(脑补零件/火花乱飞)?&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;http://localhost:4000/assets/2019-10-11_robomaster%E5%AE%89%E8%A3%859.jpg&quot; alt=&quot;2019-10-11_robomaster安装9&quot; /&gt;&lt;/p&gt;

&lt;p&gt;视频一开始说先把电池充上电, 嗯有道理, 开始找电池. 第一层先放一边, 第三层的工具比较多先拿出来, 充电器看到了! 电池么得.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;http://localhost:4000/assets/2019-10-11_robomaster%E5%AE%89%E8%A3%8510.jpg&quot; alt=&quot;2019-10-11_robomaster安装10&quot; /&gt;&lt;/p&gt;

&lt;p&gt;第二层的大件拿出来之后, 等等好像有神秘夹层, 好像看到了大脑! 电池…还是么得.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;http://localhost:4000/assets/2019-10-11_robomaster%E5%AE%89%E8%A3%8511.jpg&quot; alt=&quot;2019-10-11_robomaster安装11&quot; /&gt;&lt;/p&gt;

&lt;p&gt;把第二层的全铺出来. 电池呢?&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;http://localhost:4000/assets/2019-10-11_robomaster%E5%AE%89%E8%A3%8512.jpg&quot; alt=&quot;2019-10-11_robomaster安装12&quot; /&gt;&lt;/p&gt;

&lt;p&gt;全都在这了, 可是电池呢??&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;http://localhost:4000/assets/2019-10-11_robomaster%E5%AE%89%E8%A3%8513.jpg&quot; alt=&quot;2019-10-11_robomaster安装13&quot; /&gt;&lt;/p&gt;

&lt;p&gt;难道要出师未捷…? 不应该怀疑专业度吧(包装的印象分很高啊喂), 忍住了把泡沫包装破拆的冲动, 在这些零件里找电池, 果然!!&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;http://localhost:4000/assets/2019-10-11_robomaster%E5%AE%89%E8%A3%8514.jpg&quot; alt=&quot;2019-10-11_robomaster安装14&quot; /&gt;&lt;/p&gt;

&lt;p&gt;满上! 一开始是25-50%的样子. 半个小时, 终于要进入正题了!&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;http://localhost:4000/assets/2019-10-11_robomaster%E5%AE%89%E8%A3%8515.jpg&quot; alt=&quot;2019-10-11_robomaster安装15&quot; /&gt;&lt;/p&gt;

&lt;p&gt;视频的第一步是装轮子(最没技术含量的一步?), 花二十分钟装好了第一个之后发觉润滑也许挤得不够多, 不管先这样了, 后面的补点.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;http://localhost:4000/assets/2019-10-11_robomaster%E5%AE%89%E8%A3%8516.jpg&quot; alt=&quot;2019-10-11_robomaster安装16&quot; /&gt;&lt;/p&gt;

&lt;p&gt;从第二个开始就是这样, 润滑不会挤得太多了吧..&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;http://localhost:4000/assets/2019-10-11_robomaster%E5%AE%89%E8%A3%8517.jpg&quot; alt=&quot;2019-10-11_robomaster安装17&quot; /&gt;&lt;/p&gt;

&lt;p&gt;果然, 润滑剂比想象中的少(像牙膏一样有大气泡竟然), 到了第四个轮子已经这样了, 本来还以为有很多能剩下之后用. 希望不是过犹不及了.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;http://localhost:4000/assets/2019-10-11_robomaster%E5%AE%89%E8%A3%8518.jpg&quot; alt=&quot;2019-10-11_robomaster安装18&quot; /&gt;&lt;/p&gt;

&lt;p&gt;四个轮子装完(每个上的12个小转轮都试了一下转动情况, 有点强迫症), 用了将近一个小时..有点玄了好像.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;http://localhost:4000/assets/2019-10-11_robomaster%E5%AE%89%E8%A3%8519.jpg&quot; alt=&quot;2019-10-11_robomaster安装19&quot; /&gt;&lt;/p&gt;

&lt;p&gt;视频第二步(才到三分钟处! 原来十二分钟的视频是这个密度吗?!), 开始装机身. 这里的电源线头要从这个口拉出来接到主机板, 折腾了一下(也许有点太小心了?)&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;http://localhost:4000/assets/2019-10-11_robomaster%E5%AE%89%E8%A3%8520.jpg&quot; alt=&quot;2019-10-11_robomaster安装20&quot; /&gt;&lt;/p&gt;

&lt;p&gt;这块板要先掀开再往下装(有了之前电池的波折这就不算事了)&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;http://localhost:4000/assets/2019-10-11_robomaster%E5%AE%89%E8%A3%8521.jpg&quot; alt=&quot;2019-10-11_robomaster安装21&quot; /&gt;&lt;/p&gt;

&lt;p&gt;装上了控制板(为固定往里按的时候啪了一声后壁, 应该不那么娇贵震坏吧), 接上电源线.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;http://localhost:4000/assets/2019-10-11_robomaster%E5%AE%89%E8%A3%8522.jpg&quot; alt=&quot;2019-10-11_robomaster安装22&quot; /&gt;&lt;/p&gt;

&lt;p&gt;对了, 从装轮子开始就把护目镜脱了(后果自负). 给四个装甲装上了LED. 才发觉螺丝钉的数量很可观啊…手已经有点感觉了.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;http://localhost:4000/assets/2019-10-11_robomaster%E5%AE%89%E8%A3%8523.jpg&quot; alt=&quot;2019-10-11_robomaster安装23&quot; /&gt;&lt;/p&gt;

&lt;p&gt;装左边装甲, 为啥装不上? 按照视频的嵌入凹槽了, 但上面那片装甲又卡着前轴那边??&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;http://localhost:4000/assets/2019-10-11_robomaster%E5%AE%89%E8%A3%8524.jpg&quot; alt=&quot;2019-10-11_robomaster安装24&quot; /&gt;&lt;/p&gt;

&lt;p&gt;果然, 装不上意味着装错了. 换一边即可(还好没硬来), 接下来走线, 继续穿门洞:&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;http://localhost:4000/assets/2019-10-11_robomaster%E5%AE%89%E8%A3%8525.jpg&quot; alt=&quot;2019-10-11_robomaster安装25&quot; /&gt;&lt;/p&gt;

&lt;p&gt;装了三边装甲(左右,后), 又是一个钟头(中间去厨房把炖排骨放下, 大概刨去15分钟). 好像电池这时已经满了, 就装上了.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;http://localhost:4000/assets/2019-10-11_robomaster%E5%AE%89%E8%A3%8526.jpg&quot; alt=&quot;2019-10-11_robomaster安装26&quot; /&gt;&lt;/p&gt;

&lt;p&gt;眼看着快四点了! 加速加速, 图也少点了. 花了十五分钟装完马达. 12个螺丝…继续酸爽. 话说那些个连接线(黑色的)有三四种长度. 多亏有了视频, 不然感觉很容易分不清哪条该用在哪里.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;http://localhost:4000/assets/2019-10-11_robomaster%E5%AE%89%E8%A3%8527.jpg&quot; alt=&quot;2019-10-11_robomaster安装27&quot; /&gt;&lt;/p&gt;

&lt;p&gt;开始装前部马达, 走线有点考验手指, 中间要穿过一个洞, 设计的蛮细致的(其实一直都有感觉), 排线固定, 专业范啊.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;http://localhost:4000/assets/2019-10-11_robomaster%E5%AE%89%E8%A3%8528.jpg&quot; alt=&quot;2019-10-11_robomaster安装28&quot; /&gt;&lt;/p&gt;

&lt;p&gt;二十分钟左右装完了马达, 排线还算可以吧hoho.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;http://localhost:4000/assets/2019-10-11_robomaster%E5%AE%89%E8%A3%8529.jpg&quot; alt=&quot;2019-10-11_robomaster安装29&quot; /&gt;&lt;/p&gt;

&lt;p&gt;十分钟装完轮子, 快快快(期间照顾排骨大概刨去15分钟)! 眼看着4点半了, 还有一堆的样子.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;http://localhost:4000/assets/2019-10-11_robomaster%E5%AE%89%E8%A3%8530.jpg&quot; alt=&quot;2019-10-11_robomaster安装30&quot; /&gt;&lt;/p&gt;

&lt;p&gt;十分钟才搞定前部装甲+排线. 初见雏形, 手感挺皮实厚重的.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;http://localhost:4000/assets/2019-10-11_robomaster%E5%AE%89%E8%A3%8531.jpg&quot; alt=&quot;2019-10-11_robomaster安装31&quot; /&gt;&lt;/p&gt;

&lt;p&gt;五分钟装上云台, 装螺钉的时候转转, 好像有个限度, 一个方向只能转一圈还是两圈. 轮胎晒热了…今后就先不在大太阳底下玩了.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;http://localhost:4000/assets/2019-10-11_robomaster%E5%AE%89%E8%A3%8532.jpg&quot; alt=&quot;2019-10-11_robomaster安装32&quot; /&gt;&lt;/p&gt;

&lt;p&gt;十分钟装枪(因为不打算用水弹, 一开始就没有处理, 这里也是直接拆掉了弹匣没打算装), 和顶上的”大脑”. 螺丝已经拧木了..&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;http://localhost:4000/assets/2019-10-11_robomaster%E5%AE%89%E8%A3%8533.jpg&quot; alt=&quot;2019-10-11_robomaster安装33&quot; /&gt;&lt;/p&gt;

&lt;p&gt;最后十分钟冲刺! 前置摄像头, 连线, 扬声器连线! 五点钟终于完成!&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;http://localhost:4000/assets/2019-10-11_robomaster%E5%AE%89%E8%A3%8534.jpg&quot; alt=&quot;2019-10-11_robomaster安装34&quot; /&gt;&lt;/p&gt;

&lt;p&gt;昂首挺胸来一张!&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;http://localhost:4000/assets/2019-10-11_robomaster%E5%AE%89%E8%A3%8535.jpg&quot; alt=&quot;2019-10-11_robomaster安装35&quot; /&gt;&lt;/p&gt;

&lt;p&gt;结果摄像头对着夕阳十分钟才发现…希望没事啊…&lt;/p&gt;

&lt;p&gt;因为完全没来得及试机, 所以只能算到了门前, 还差临门一脚. 敬请期待吧!&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;&lt;em&gt;此文写了两个钟头. 请不吝三连!&lt;/em&gt;&lt;/strong&gt;&lt;/p&gt;

&lt;p&gt;(刚看到新闻说大疆因为关税在美国产品涨价…难怪机甲涨了10%)&lt;/p&gt;</content><author><name></name></author><summary type="html">2010年之后再没碰过机器人的准新手在向大疆官方确认过Python开发支持使用中文命名标识符之后(应该是独一无二的理由吧), 终于下决心入手.</summary></entry><entry><title type="html">自制TTS引擎第0.02步-单字拼音化, 从Excel表格用Python提取拼音表</title><link href="http://localhost:4000/%E5%91%BD%E5%90%8D/python/2019/10/08/%E8%87%AA%E5%88%B6TTS%E5%BC%95%E6%93%8E%E7%AC%AC0.02%E6%AD%A5-%E5%8D%95%E5%AD%97%E6%8B%BC%E9%9F%B3%E5%8C%96,-%E4%BB%8EExcel%E8%A1%A8%E6%A0%BC%E7%94%A8Python%E6%8F%90%E5%8F%96%E6%8B%BC%E9%9F%B3%E8%A1%A8.html" rel="alternate" type="text/html" title="自制TTS引擎第0.02步-单字拼音化, 从Excel表格用Python提取拼音表" /><published>2019-10-08T00:00:00-07:00</published><updated>2019-10-08T00:00:00-07:00</updated><id>http://localhost:4000/%E5%91%BD%E5%90%8D/python/2019/10/08/%E8%87%AA%E5%88%B6TTS%E5%BC%95%E6%93%8E%E7%AC%AC0.02%E6%AD%A5-%E5%8D%95%E5%AD%97%E6%8B%BC%E9%9F%B3%E5%8C%96,%20%E4%BB%8EExcel%E8%A1%A8%E6%A0%BC%E7%94%A8Python%E6%8F%90%E5%8F%96%E6%8B%BC%E9%9F%B3%E8%A1%A8</id><content type="html" xml:base="http://localhost:4000/%E5%91%BD%E5%90%8D/python/2019/10/08/%E8%87%AA%E5%88%B6TTS%E5%BC%95%E6%93%8E%E7%AC%AC0.02%E6%AD%A5-%E5%8D%95%E5%AD%97%E6%8B%BC%E9%9F%B3%E5%8C%96,-%E4%BB%8EExcel%E8%A1%A8%E6%A0%BC%E7%94%A8Python%E6%8F%90%E5%8F%96%E6%8B%BC%E9%9F%B3%E8%A1%A8.html">&lt;p&gt;续上文: &lt;a href=&quot;https://zhuanlan.zhihu.com/p/85486162&quot;&gt;自制TTS引擎第0.01步-Python实现拼接单字wav文件&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;首先, 利用第三方库&lt;a href=&quot;https://github.com/program-in-chinese/study/blob/master/1-%E5%9F%BA%E7%A1%80/wav%E6%96%87%E4%BB%B6%E5%A4%84%E7%90%86/%E5%90%88%E6%88%90.py&quot;&gt;获取中文字符对应拼音&lt;/a&gt;:&lt;/p&gt;
&lt;div class=&quot;language-python highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;kn&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;xpinyin&lt;/span&gt; &lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Pinyin&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;...&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;err&quot;&gt;单字&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;err&quot;&gt;文字&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;c&quot;&gt;# TODO: 多系统/&lt;/span&gt;
        &lt;span class=&quot;err&quot;&gt;拼音&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;err&quot;&gt;拼音库&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;get_pinyin&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;err&quot;&gt;单字&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tone_marks&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'numbers'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;err&quot;&gt;格式信息&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;err&quot;&gt;从&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;wav&lt;/span&gt;&lt;span class=&quot;err&quot;&gt;文件读取信息&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;单字/&quot;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;err&quot;&gt;拼音&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;.wav&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;然后将wav文件改为拼音命名, 比如”中.wav”改为”zhong1.wav”, 顺手将单字(“我是中国人”五个字)的wav文件裁剪为0.35秒左右, 减少了前后空白, 拼接起来效果听起来好一些.&lt;/p&gt;

&lt;p&gt;下面需要整理一份拼音全表. 用了网上下载的一个xls表, 格式如下:&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;http://localhost:4000/assets/2019-10-08_excel%E6%8B%BC%E9%9F%B3%E8%A1%A8.png&quot; alt=&quot;2019-10-08_excel拼音表&quot; /&gt;&lt;/p&gt;

&lt;p&gt;输出所有存在的拼音, 比如a, 包括入声和四声都有, 则输出 a0, a1, a2, a3, a4; 如&lt;code class=&quot;highlighter-rouge&quot;&gt;bu&lt;/code&gt;, 则输出bu1, bu3, bu4&lt;/p&gt;

&lt;p&gt;同样用Python处理xlsx表格, 之前好像没有贴过类似代码. 节选如下(完整代码&lt;a href=&quot;https://github.com/program-in-chinese/study/blob/master/2.1-topic%EF%BC%9A%E6%95%B0%E6%8D%AE%E5%A4%84%E7%90%86/%E6%8B%BC%E9%9F%B3%E8%A1%A8/%E6%8B%BC%E9%9F%B3%E6%8F%90%E5%8F%96.py&quot;&gt;在此&lt;/a&gt;):&lt;/p&gt;
&lt;div class=&quot;language-python highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;kn&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;openpyxl&lt;/span&gt; &lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;load_workbook&lt;/span&gt;

&lt;span class=&quot;err&quot;&gt;开始行&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;3&lt;/span&gt;
&lt;span class=&quot;err&quot;&gt;结束行&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;205&lt;/span&gt;

&lt;span class=&quot;err&quot;&gt;所有拼音&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[]&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;err&quot;&gt;遍历表格(文件名):
    工作簿 = &lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;load_workbook&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;err&quot;&gt;文件名&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;err&quot;&gt;表单&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;err&quot;&gt;工作簿&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;active&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;err&quot;&gt;行&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;range&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;err&quot;&gt;开始行&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;err&quot;&gt;结束行&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;err&quot;&gt;拼音序号&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;range&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
            &lt;span class=&quot;err&quot;&gt;拼音所在列&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;err&quot;&gt;拼音序号&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;6&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;
            &lt;span class=&quot;err&quot;&gt;拼音&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;err&quot;&gt;表单&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;cell&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;row&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;err&quot;&gt;行&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;column&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;err&quot;&gt;拼音所在列&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;value&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;lower&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;

            &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;err&quot;&gt;列&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;range&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;err&quot;&gt;拼音所在列&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;err&quot;&gt;拼音所在列&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;6&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
                &lt;span class=&quot;err&quot;&gt;对应字&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;err&quot;&gt;表单&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;cell&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;row&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;err&quot;&gt;行&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;column&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;err&quot;&gt;列&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;value&lt;/span&gt;
                &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;err&quot;&gt;对应字&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;!=&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;None&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
                    &lt;span class=&quot;err&quot;&gt;所有拼音&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;append&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;err&quot;&gt;拼音&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;str&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;err&quot;&gt;列&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;err&quot;&gt;拼音所在列&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;输出&lt;strong&gt;&lt;em&gt;1238&lt;/em&gt;&lt;/strong&gt;个, 如下:&lt;/p&gt;
&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;a0
a1
a2
a3
a4
ai1
ai2
ai3
ai4
an1
an3
an4
ang1
ang2
ang4
...
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;全表见此: &lt;a href=&quot;https://github.com/program-in-chinese/study/blob/master/2.1-topic%EF%BC%9A%E6%95%B0%E6%8D%AE%E5%A4%84%E7%90%86/%E6%8B%BC%E9%9F%B3%E8%A1%A8/%E6%89%80%E6%9C%89%E6%8B%BC%E9%9F%B3.txt&quot;&gt;所有拼音&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;接下去就是体力活, 录音. 打算用一段稍长的文字作演示.&lt;/p&gt;</content><author><name></name></author><summary type="html">续上文: 自制TTS引擎第0.01步-Python实现拼接单字wav文件</summary></entry><entry><title type="html">自制TTS引擎第0.01步-Python实现拼接单字wav文件</title><link href="http://localhost:4000/%E5%91%BD%E5%90%8D/python/2019/10/07/%E8%87%AA%E5%88%B6TTS%E5%BC%95%E6%93%8E%E7%AC%AC0.01%E6%AD%A5-Python%E5%AE%9E%E7%8E%B0%E6%8B%BC%E6%8E%A5%E5%8D%95%E5%AD%97wav%E6%96%87%E4%BB%B6.html" rel="alternate" type="text/html" title="自制TTS引擎第0.01步-Python实现拼接单字wav文件" /><published>2019-10-07T00:00:00-07:00</published><updated>2019-10-07T00:00:00-07:00</updated><id>http://localhost:4000/%E5%91%BD%E5%90%8D/python/2019/10/07/%E8%87%AA%E5%88%B6TTS%E5%BC%95%E6%93%8E%E7%AC%AC0.01%E6%AD%A5-Python%E5%AE%9E%E7%8E%B0%E6%8B%BC%E6%8E%A5%E5%8D%95%E5%AD%97wav%E6%96%87%E4%BB%B6</id><content type="html" xml:base="http://localhost:4000/%E5%91%BD%E5%90%8D/python/2019/10/07/%E8%87%AA%E5%88%B6TTS%E5%BC%95%E6%93%8E%E7%AC%AC0.01%E6%AD%A5-Python%E5%AE%9E%E7%8E%B0%E6%8B%BC%E6%8E%A5%E5%8D%95%E5%AD%97wav%E6%96%87%E4%BB%B6.html">&lt;p&gt;&lt;img src=&quot;http://localhost:4000/assets/2019-10-07_audacity.png&quot; alt=&quot;2019-10-07_audacity&quot; /&gt;&lt;/p&gt;

&lt;p&gt;一些参考资料在: &lt;a href=&quot;https://www.zhihu.com/question/263570139/answer/845792385&quot;&gt;怎样自己做一个tts引擎？&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;演示(文本源自小学一年级课文):
&lt;a href=&quot;https://www.bilibili.com/audio/au1100814?type=1&quot;&gt;Python实现wav文件合并演示1: 我是中国人​&lt;/a&gt;
&lt;a href=&quot;https://www.bilibili.com/audio/au1100815?type=1&quot;&gt;Python实现拼接wav文件演示: 我是小学生​&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;尚未找到开源和成熟的中文TTS引擎, 于是先自己摸索一下. 实现思路很原始, 自己读一系列单字, 用Audacity录成wav文件. 再写个Python脚本, 将输入文本中的单字对应的wav文件进行直接拼接生成新wav文件.&lt;/p&gt;

&lt;p&gt;源码和单字音频资源在: &lt;a href=&quot;https://github.com/program-in-chinese/study/blob/master/1-%E5%9F%BA%E7%A1%80/wav%E6%96%87%E4%BB%B6%E5%A4%84%E7%90%86/%E5%90%88%E6%88%90.py&quot;&gt;wav文件处理/合成.py&lt;/a&gt;&lt;/p&gt;
&lt;div class=&quot;language-python highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;wave&lt;/span&gt;

&lt;span class=&quot;c&quot;&gt;# 参考: https://blog.csdn.net/qq_39516859/article/details/79819276&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;err&quot;&gt;从&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;wav&lt;/span&gt;&lt;span class=&quot;err&quot;&gt;文件读取信息&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;err&quot;&gt;文件名&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
    &lt;span class=&quot;c&quot;&gt;#打开wav文件 ，open返回一个的是一个Wave_read类的实例，通过调用它的方法读取WAV文件的格式和数据。&lt;/span&gt;
    &lt;span class=&quot;err&quot;&gt;文件&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;wave&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;open&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;err&quot;&gt;文件名&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;rb&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;c&quot;&gt;#读取格式信息&lt;/span&gt;
    &lt;span class=&quot;err&quot;&gt;帧数&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;err&quot;&gt;文件&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;getnframes&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
    &lt;span class=&quot;err&quot;&gt;信息&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;s&quot;&gt;&quot;帧&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;err&quot;&gt;文件&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;readframes&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;err&quot;&gt;帧数&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt;
        &lt;span class=&quot;s&quot;&gt;&quot;频道数&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;err&quot;&gt;文件&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;getnchannels&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(),&lt;/span&gt;
        &lt;span class=&quot;s&quot;&gt;&quot;量化位数&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;err&quot;&gt;文件&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;getsampwidth&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(),&lt;/span&gt;
        &lt;span class=&quot;s&quot;&gt;&quot;帧速&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;err&quot;&gt;文件&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;getframerate&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
    &lt;span class=&quot;err&quot;&gt;文件&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;close&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;err&quot;&gt;信息&lt;/span&gt;

&lt;span class=&quot;c&quot;&gt;# 参考: https://blog.csdn.net/zzZ_CMing/article/details/81739193&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;err&quot;&gt;合成(文字):
    帧 = &lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;b&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;''&lt;/span&gt;
    &lt;span class=&quot;err&quot;&gt;格式信息&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{}&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;err&quot;&gt;字&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;err&quot;&gt;文字&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;c&quot;&gt;# TODO: 多系统/&lt;/span&gt;
        &lt;span class=&quot;err&quot;&gt;格式信息&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;err&quot;&gt;从&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;wav&lt;/span&gt;&lt;span class=&quot;err&quot;&gt;文件读取信息&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;单字/&quot;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;err&quot;&gt;字&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;.wav&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;err&quot;&gt;帧&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+=&lt;/span&gt; &lt;span class=&quot;err&quot;&gt;格式信息&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;帧&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;

    &lt;span class=&quot;err&quot;&gt;文件&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;wave&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;open&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;输出/&quot;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;err&quot;&gt;文字&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;.wav&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;'wb'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;err&quot;&gt;文件&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;setnchannels&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;err&quot;&gt;格式信息&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;频道数&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt;
    &lt;span class=&quot;err&quot;&gt;文件&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;setsampwidth&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;err&quot;&gt;格式信息&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;量化位数&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt;
    &lt;span class=&quot;err&quot;&gt;文件&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;setframerate&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;err&quot;&gt;格式信息&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;帧速&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt;
    &lt;span class=&quot;err&quot;&gt;文件&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;writeframes&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;err&quot;&gt;帧&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;err&quot;&gt;文件&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;close&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;

    &lt;span class=&quot;k&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;*&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;10&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;合成结束&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\n&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;err&quot;&gt;合成&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;我是中国人&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;err&quot;&gt;合成&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;我是小学生&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;h3 id=&quot;待改进&quot;&gt;待改进&lt;/h3&gt;

&lt;ul&gt;
  &lt;li&gt;需对单字音频作修剪处理, 否则单字间的间隔太大&lt;/li&gt;
  &lt;li&gt;更全的单字音频. 之前还在算要怎么先录最常用的几千字的音频, 刚意识到不如录所有拼音的音频, 然后将文字转换成拼音(是的这里就有坑, 但是TTS本身就是大坑). 粗看一下拼音组合大概不到500(汉语拼音最全组合 - 百度文库), 按4个音调不到2000.&lt;/li&gt;
  &lt;li&gt;欢迎拍砖&lt;/li&gt;
&lt;/ul&gt;</content><author><name></name></author><summary type="html"></summary></entry><entry><title type="html">尝试自动批量翻译方舟编译器源码中的标识符</title><link href="http://localhost:4000/%E5%91%BD%E5%90%8D/%E6%96%B9%E8%88%9F%E7%BC%96%E8%AF%91%E5%99%A8/2019/10/02/%E5%B0%9D%E8%AF%95%E8%87%AA%E5%8A%A8%E6%89%B9%E9%87%8F%E7%BF%BB%E8%AF%91%E6%96%B9%E8%88%9F%E7%BC%96%E8%AF%91%E5%99%A8%E6%BA%90%E7%A0%81%E4%B8%AD%E7%9A%84%E6%A0%87%E8%AF%86%E7%AC%A6.html" rel="alternate" type="text/html" title="尝试自动批量翻译方舟编译器源码中的标识符" /><published>2019-10-02T00:00:00-07:00</published><updated>2019-10-02T00:00:00-07:00</updated><id>http://localhost:4000/%E5%91%BD%E5%90%8D/%E6%96%B9%E8%88%9F%E7%BC%96%E8%AF%91%E5%99%A8/2019/10/02/%E5%B0%9D%E8%AF%95%E8%87%AA%E5%8A%A8%E6%89%B9%E9%87%8F%E7%BF%BB%E8%AF%91%E6%96%B9%E8%88%9F%E7%BC%96%E8%AF%91%E5%99%A8%E6%BA%90%E7%A0%81%E4%B8%AD%E7%9A%84%E6%A0%87%E8%AF%86%E7%AC%A6</id><content type="html" xml:base="http://localhost:4000/%E5%91%BD%E5%90%8D/%E6%96%B9%E8%88%9F%E7%BC%96%E8%AF%91%E5%99%A8/2019/10/02/%E5%B0%9D%E8%AF%95%E8%87%AA%E5%8A%A8%E6%89%B9%E9%87%8F%E7%BF%BB%E8%AF%91%E6%96%B9%E8%88%9F%E7%BC%96%E8%AF%91%E5%99%A8%E6%BA%90%E7%A0%81%E4%B8%AD%E7%9A%84%E6%A0%87%E8%AF%86%E7%AC%A6.html">&lt;p&gt;在对方舟编译器源码中的近百个标识符/字符串常量进行手工汉化后, 尝试用&lt;a href=&quot;https://github.com/program-in-chinese/ark_compiler_source_translation&quot;&gt;批量替换+字典&lt;/a&gt;的方式对源码标识符进行自动翻译, 目标是自动翻译后达到与手工相同的效果.&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://github.com/program-in-chinese/ark_compiler_source_translation/blob/master/src/com/codeinchinese/%E6%BA%90%E7%A0%81/%E7%BF%BB%E8%AF%91/%E6%BA%90%E7%A0%81%E5%A4%84%E7%90%86.java#L25&quot;&gt;字典&lt;/a&gt;来源于&lt;a href=&quot;https://gitee.com/Program-in-Chinese/OpenArkCompiler/commits/master&quot;&gt;之前的手动提交&lt;/a&gt;. 批量替换之前基本没有任何语法分析, 仅有不完全的注释/字符串识别处理. 阶段小结如下.&lt;/p&gt;

&lt;p&gt;处理的结果与之前的手动修改比较. 生成的diff大约30k, 大约60多处不同. 相对修改的上千处代码来说, 比例很小.&lt;/p&gt;
&lt;h3 id=&quot;存在的几种问题&quot;&gt;存在的几种问题&lt;/h3&gt;

&lt;ol&gt;
  &lt;li&gt;
    &lt;p&gt;同名标识符
 有些本地标识符没有被替换的, 如&lt;code class=&quot;highlighter-rouge&quot;&gt;DefaultOption&lt;/code&gt;中的&lt;code class=&quot;highlighter-rouge&quot;&gt;mplOptions&lt;/code&gt;. 在汉化过程中, 同名标识符可能属于不同类, 不一定使用同一中文翻译, 这种情况暂时无法处理, 需要语法分析.&lt;/p&gt;

    &lt;p&gt;统计(diff中的出现次数, 下同): 4 8 5 3 1 3 2&lt;/p&gt;

    &lt;p&gt;ret是否全都是”返回”的语义需逐个检查. 之前并非全局替换.&lt;/p&gt;

    &lt;p&gt;统计: 7&lt;/p&gt;

    &lt;p&gt;还有&lt;code class=&quot;highlighter-rouge&quot;&gt;OptionParser&lt;/code&gt;中的&lt;code class=&quot;highlighter-rouge&quot;&gt;Parse&lt;/code&gt;, 也和&lt;code class=&quot;highlighter-rouge&quot;&gt;Compiler&lt;/code&gt;的&lt;code class=&quot;highlighter-rouge&quot;&gt;Parse&lt;/code&gt;重名.&lt;/p&gt;

    &lt;p&gt;统计: 2 1&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;注释与字符串
 一些标识符在注释/字符串中也应翻译, 如:&lt;code class=&quot;highlighter-rouge&quot;&gt;ASSERT(i == 0, &quot;Invalid operand idx in UnaryNode&quot;);&lt;/code&gt;中的&lt;code class=&quot;highlighter-rouge&quot;&gt;UnaryNode&lt;/code&gt;.
 统计: 15 11 1
 当前默认不翻译, 是为了避免不完整翻译. 比如避免&lt;code class=&quot;highlighter-rouge&quot;&gt;&quot;Error while Exe, cmd: &quot;&lt;/code&gt;这一字符串被译为&lt;code class=&quot;highlighter-rouge&quot;&gt;&quot;Error while 运行, cmd: &quot;&lt;/code&gt;&lt;/li&gt;
  &lt;li&gt;标识符替换的硬伤:
    &lt;div class=&quot;language-diff highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;gd&quot;&gt;-    LogInfo::MapleLogger() &amp;lt;&amp;lt; &quot;/* &amp;amp;&quot; &amp;lt;&amp;lt; GlobalTables::GetGsymTable().GetSymbolFromStidx(m.first.Idx())-&amp;gt;求名称();
&lt;/span&gt;&lt;span class=&quot;gi&quot;&gt;+    LogInfo::MapleLogger() &amp;lt;&amp;lt; &quot;/* &amp;amp;&quot; &amp;lt;&amp;lt; GlobalTables::GetGsymTable().GetSymbolFromStidx(m.first.Idx())-&amp;gt;GetName();
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;    &lt;/div&gt;
    &lt;p&gt;此处由于字符串中带有&lt;code class=&quot;highlighter-rouge&quot;&gt;/*&lt;/code&gt;, 因此被误判为注释因而&lt;code class=&quot;highlighter-rouge&quot;&gt;GetName&lt;/code&gt;未被翻译&lt;/p&gt;
  &lt;/li&gt;
&lt;/ol&gt;

&lt;p&gt;统计: 2 1 2&lt;/p&gt;

&lt;ol&gt;
  &lt;li&gt;命名冲突
    &lt;div class=&quot;language-cpp highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;k&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;err&quot;&gt;运行&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;err&quot;&gt;选项类&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;amp;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;mplOptions&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;std&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;::&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;string&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;amp;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;options&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;const&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;    &lt;/div&gt;
    &lt;p&gt;其他多数情况下, &lt;code class=&quot;highlighter-rouge&quot;&gt;mplOptions&lt;/code&gt;和&lt;code class=&quot;highlighter-rouge&quot;&gt;options&lt;/code&gt;都被翻译成”选项”, 并无冲突. 但这种情况下, 需要区别.&lt;/p&gt;
  &lt;/li&gt;
&lt;/ol&gt;

&lt;p&gt;统计: 1&lt;/p&gt;
&lt;h3 id=&quot;问题分析&quot;&gt;问题分析&lt;/h3&gt;

&lt;ul&gt;
  &lt;li&gt;2可通过只当某些标识符在注释/字符串中出现时翻译来规避.&lt;/li&gt;
  &lt;li&gt;多数问题(1, 3, 4)需要更进一步的语法分析. 包括字符串/注释的识别, 以及不同类中的同名域的区分等等. 最好借助于现成的C++语言分析器.
    &lt;h3 id=&quot;自动修改的优点&quot;&gt;自动修改的优点&lt;/h3&gt;
  &lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;相比手工修改, 减少了不少低级错误(已在主库修正). 比如手工替换时&lt;a href=&quot;https://gitee.com/Program-in-Chinese/OpenArkCompiler/commit/8fb2df390111bfb87b811ae59a1d67e472f304ca&quot;&gt;未注意大小写&lt;/a&gt;, 以及未对整体标识符&lt;a href=&quot;https://gitee.com/Program-in-Chinese/OpenArkCompiler/commit/09f53b582b5d0b05600894c5a289c11673413948&quot;&gt;进行替换&lt;/a&gt;等等.&lt;/p&gt;
&lt;h3 id=&quot;结论&quot;&gt;结论&lt;/h3&gt;

&lt;ol&gt;
  &lt;li&gt;使用程序进行源码自动修改有可行性, 即使工具很简陋&lt;/li&gt;
  &lt;li&gt;在找到好用的C++源码分析器之前, 暂停改进此自动修改工具&lt;/li&gt;
&lt;/ol&gt;</content><author><name></name></author><summary type="html">在对方舟编译器源码中的近百个标识符/字符串常量进行手工汉化后, 尝试用批量替换+字典的方式对源码标识符进行自动翻译, 目标是自动翻译后达到与手工相同的效果.</summary></entry><entry><title type="html">手工翻译方舟编译器源码: IR相关节点类</title><link href="http://localhost:4000/%E5%91%BD%E5%90%8D/%E6%96%B9%E8%88%9F%E7%BC%96%E8%AF%91%E5%99%A8/2019/09/10/%E6%89%8B%E5%B7%A5%E7%BF%BB%E8%AF%91%E6%96%B9%E8%88%9F%E7%BC%96%E8%AF%91%E5%99%A8%E6%BA%90%E7%A0%81-IR%E7%9B%B8%E5%85%B3%E8%8A%82%E7%82%B9%E7%B1%BB.html" rel="alternate" type="text/html" title="手工翻译方舟编译器源码: IR相关节点类" /><published>2019-09-10T00:00:00-07:00</published><updated>2019-09-10T00:00:00-07:00</updated><id>http://localhost:4000/%E5%91%BD%E5%90%8D/%E6%96%B9%E8%88%9F%E7%BC%96%E8%AF%91%E5%99%A8/2019/09/10/%E6%89%8B%E5%B7%A5%E7%BF%BB%E8%AF%91%E6%96%B9%E8%88%9F%E7%BC%96%E8%AF%91%E5%99%A8%E6%BA%90%E7%A0%81:%20IR%E7%9B%B8%E5%85%B3%E8%8A%82%E7%82%B9%E7%B1%BB</id><content type="html" xml:base="http://localhost:4000/%E5%91%BD%E5%90%8D/%E6%96%B9%E8%88%9F%E7%BC%96%E8%AF%91%E5%99%A8/2019/09/10/%E6%89%8B%E5%B7%A5%E7%BF%BB%E8%AF%91%E6%96%B9%E8%88%9F%E7%BC%96%E8%AF%91%E5%99%A8%E6%BA%90%E7%A0%81-IR%E7%9B%B8%E5%85%B3%E8%8A%82%E7%82%B9%E7%B1%BB.html">&lt;p&gt;&lt;img src=&quot;http://localhost:4000/assets/2019-09-10_ark%E9%87%8D%E5%91%BD%E5%90%8DIR.png&quot; alt=&quot;2019-09-10_ark重命名IR&quot; /&gt;&lt;/p&gt;

&lt;p&gt;本系列进展跟踪帖: &lt;a href=&quot;https://github.com/program-in-chinese/overview/issues/166&quot;&gt;方舟编译器中文化的相关话题 · Issue #166 · program-in-chinese/overview&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;续上文: &lt;a href=&quot;https://zhuanlan.zhihu.com/p/81450947&quot;&gt;吴烜：手工翻译方舟编译器源码:尝试重命名标识符与文本&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;节点类中文化后的&lt;code class=&quot;highlighter-rouge&quot;&gt;opcodes.def&lt;/code&gt;节选如下:&lt;/p&gt;
&lt;div class=&quot;language-c highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;  &lt;span class=&quot;n&quot;&gt;OPCODE&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;dassign&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;err&quot;&gt;直接赋值节点类&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;OPCODEISSTMT&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;|&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;OPCODENOTMMPL&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;|&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;OPCODEHASSSADEF&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;8&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;OPCODE&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;maydassign&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;err&quot;&gt;直接赋值节点类&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;OPCODEISSTMT&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;|&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;OPCODENOTMMPL&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;|&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;OPCODEHASSSADEF&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;8&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;OPCODE&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;iassign&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;err&quot;&gt;间接赋值节点类&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;OPCODEISSTMT&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;|&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;OPCODENOTMMPL&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;|&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;OPCODEHASSSADEF&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;12&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
  &lt;span class=&quot;c1&quot;&gt;// hierarchical control flow opcodes
&lt;/span&gt;  &lt;span class=&quot;n&quot;&gt;OPCODE&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;block&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;err&quot;&gt;块节点类&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;OPCODEISSTMT&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;|&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;OPCODENOTMMPL&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;OPCODE&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;doloop&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;err&quot;&gt;循环节点类&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;OPCODEISSTMT&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;|&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;OPCODENOTMMPL&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;OPCODE&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;dowhile&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;While&lt;/span&gt;&lt;span class=&quot;err&quot;&gt;声明节点类&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;OPCODEISSTMT&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;|&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;OPCODENOTMMPL&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;OPCODE&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;if&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;If&lt;/span&gt;&lt;span class=&quot;err&quot;&gt;声明节点类&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;OPCODEISSTMT&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;|&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;OPCODENOTMMPL&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;OPCODE&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;while&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;While&lt;/span&gt;&lt;span class=&quot;err&quot;&gt;声明节点类&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;OPCODEISSTMT&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;|&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;OPCODENOTMMPL&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;OPCODE&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;switch&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Switch&lt;/span&gt;&lt;span class=&quot;err&quot;&gt;节点类&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;OPCODEISSTMT&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;|&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;OPCODENOTMMPL&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;8&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;OPCODE&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;multiway&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;err&quot;&gt;多路节点类&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;OPCODEISSTMT&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;|&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;OPCODENOTMMPL&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;8&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;OPCODE&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;foreachelem&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;err&quot;&gt;遍历元素节点类&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;OPCODEISSTMT&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;|&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;OPCODENOTMMPL&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;完整在: &lt;a href=&quot;https://gitee.com/Program-in-Chinese/OpenArkCompiler/blob/master/src/maple_ir/include/opcodes.def&quot;&gt;src/maple_ir/include/opcodes.def · 中文编程/OpenArkCompiler - Gitee&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;仍可编译输出, 自带helloworld例程编译运行通过.&lt;/p&gt;

&lt;p&gt;期间发现几个文档中没说明的操作符, 问题已提交到官网: &lt;a href=&quot;https://code.opensource.huaweicloud.com/HarmonyOS/OpenArkCompiler/issues/168&quot;&gt;华为开源平台&lt;/a&gt;[👍, 刚收到官方回复]:&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;语法是: fieldsdist &lt;int-prim-type&gt; &lt;type&gt; &lt;field-id1&gt; &lt;field-id2&gt;
这个opcode的作用是得到一个类型&lt;type&gt;里两个域&lt;field-id1&gt;和&lt;field-id2&gt;的距离。&lt;/field-id2&gt;&lt;/field-id1&gt;&lt;/type&gt;&lt;/field-id2&gt;&lt;/field-id1&gt;&lt;/type&gt;&lt;/int-prim-type&gt;&lt;/p&gt;
&lt;/blockquote&gt;

&lt;blockquote&gt;
  &lt;p&gt;resolveinterfacefunc和resolvevirtualfunc这两个和fielddist都是编译器内部优化引入的，不在对外暴露和使用的IR内，所以没有放在MapleIRDesign中。&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;另有几个问题:&lt;/p&gt;

&lt;ol&gt;
  &lt;li&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;NaryStmtNode&lt;/code&gt;中的”Nary”不知何意.&lt;/li&gt;
  &lt;li&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;IntrinsiccallNode&lt;/code&gt;和&lt;code class=&quot;highlighter-rouge&quot;&gt;IntrinsicopNode&lt;/code&gt;中的”Intrinsic”还在斟酌对应中文, 欢迎建议.&lt;/li&gt;
  &lt;li&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;StmtNode&lt;/code&gt;重命名为”声明节点类”后, 编译报错: “undefined reference to “maple::FuncOptimizeImpl::ProcessBlock(声明节点类 *stmt)”, 不知是否与deplibs中的库有关. 暂时跳过此类.&lt;/li&gt;
&lt;/ol&gt;

&lt;p&gt;基本上重命名采取vscode中批量替换, 如果用change all occurrences, 好像只能替换当前文件中的引用. 除了&lt;code class=&quot;highlighter-rouge&quot;&gt;StmtNode&lt;/code&gt;之外没有发现重构导致的问题. 编译一次约用2分钟, 尚可接受.&lt;/p&gt;

&lt;p&gt;在中文化过程中, 通过阅读MapleIRDesign.md(希望早出中文版)对不同分类的IR节点有了初步理解, 操作符从接近汇编的到高层工作流(如循环/遍历)都有, 下面想试着了解一下整体编译过程. 如已有文章梳理请不吝告知!&lt;/p&gt;</content><author><name></name></author><summary type="html"></summary></entry><entry><title type="html">尝试方舟编译器下对Java中标识符中文命名</title><link href="http://localhost:4000/%E5%91%BD%E5%90%8D/%E6%96%B9%E8%88%9F%E7%BC%96%E8%AF%91%E5%99%A8/2019/09/08/%E5%B0%9D%E8%AF%95%E6%96%B9%E8%88%9F%E7%BC%96%E8%AF%91%E5%99%A8%E4%B8%8B%E5%AF%B9Java%E4%B8%AD%E6%A0%87%E8%AF%86%E7%AC%A6%E4%B8%AD%E6%96%87%E5%91%BD%E5%90%8D.html" rel="alternate" type="text/html" title="尝试方舟编译器下对Java中标识符中文命名" /><published>2019-09-08T00:00:00-07:00</published><updated>2019-09-08T00:00:00-07:00</updated><id>http://localhost:4000/%E5%91%BD%E5%90%8D/%E6%96%B9%E8%88%9F%E7%BC%96%E8%AF%91%E5%99%A8/2019/09/08/%E5%B0%9D%E8%AF%95%E6%96%B9%E8%88%9F%E7%BC%96%E8%AF%91%E5%99%A8%E4%B8%8B%E5%AF%B9Java%E4%B8%AD%E6%A0%87%E8%AF%86%E7%AC%A6%E4%B8%AD%E6%96%87%E5%91%BD%E5%90%8D</id><content type="html" xml:base="http://localhost:4000/%E5%91%BD%E5%90%8D/%E6%96%B9%E8%88%9F%E7%BC%96%E8%AF%91%E5%99%A8/2019/09/08/%E5%B0%9D%E8%AF%95%E6%96%B9%E8%88%9F%E7%BC%96%E8%AF%91%E5%99%A8%E4%B8%8B%E5%AF%B9Java%E4%B8%AD%E6%A0%87%E8%AF%86%E7%AC%A6%E4%B8%AD%E6%96%87%E5%91%BD%E5%90%8D.html">&lt;p&gt;之前承蒙这位测试, 方舟编译器支持Java下的中文命名标识符: &lt;a href=&quot;https://gitee.com/harmonyos/OpenArkCompiler/issues/I11R87#note_1975102&quot;&gt;跑不通的可参考Z乎的这篇文章，已找到一个可使测试用例编译通过的java-core库 · Issue #I11R87 · HarmonyOS/OpenArkCompiler - 码云 Gitee.com&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;为了确认之前(&lt;a href=&quot;https://zhuanlan.zhihu.com/p/81450947&quot;&gt;手工翻译方舟编译器源码:尝试重命名标识符与文本&lt;/a&gt;)的源码汉化不会影响编译, 自己也试试.&lt;/p&gt;

&lt;p&gt;编译方法参考: &lt;a href=&quot;https://zhuanlan.zhihu.com/p/81340230&quot;&gt;小乖他爹：方舟编译器学习笔记8 工具链可运行（helloworld编译成功）&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;注: 留意jbc2mpl命令需在libjava-core下运行, 否则报错”Unable to open java-core.jar”.&lt;/p&gt;

&lt;p&gt;编译helloworld后, 运行$java HelloWorld输出”Hello World!”无误.&lt;/p&gt;

&lt;p&gt;下面改为你好.java 如下:&lt;/p&gt;
&lt;div class=&quot;language-java highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;kd&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;kd&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;err&quot;&gt;你好&lt;/span&gt; &lt;span class=&quot;err&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;nc&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;kd&quot;&gt;static&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;main&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;String&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;[]&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;args&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;System&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;out&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;println&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;吃了么!&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;
    &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;Makefile修改为:&lt;/p&gt;
&lt;div class=&quot;language-makefile highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nv&quot;&gt;APP&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; 你好
&lt;span class=&quot;err&quot;&gt;include&lt;/span&gt; &lt;span class=&quot;err&quot;&gt;$(MAPLE_BUILD_CORE)/maple_test.mk&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;照前一样编译, 运行&lt;code class=&quot;highlighter-rouge&quot;&gt;$java 你好&lt;/code&gt;也正确输出”吃了么!” (09/13补: 貌似生成.class这步是用了OpenJDK而非方舟?)&lt;/p&gt;

&lt;p&gt;比较在意的是, 生成的.class文件小一些在预料之内, 但其他所有文件比英文的大一圈(如下):&lt;/p&gt;
&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;-rw-r--r-- 1 xw xw   534 Sep  8 03:25 HelloWorld.class
-rw-r--r-- 1 xw xw   790 Sep  8 03:25 HelloWorld.jar
-rw-r--r-- 1 xw xw   124 Sep  8 04:33 HelloWorld.java
-rw-r--r-- 1 xw xw  2442 Sep  8 03:47 HelloWorld.mpl
-rw-r--r-- 1 xw xw   488 Sep  8 03:47 HelloWorld.mplt
-rw-r--r-- 1 xw xw     0 Sep  8 03:47 HelloWorld.VtableImpl.groots.txt
-rw-r--r-- 1 xw xw 12517 Sep  8 03:47 HelloWorld.VtableImpl.mpl
-rw-r--r-- 1 xw xw   118 Sep  8 03:47 HelloWorld.VtableImpl.primordials.txt
-rw-r--r-- 1 xw xw 20520 Sep  8 03:47 HelloWorld.VtableImpl.s
-rw-r--r-- 1 xw xw    55 Sep  8 03:49 Makefile
-rw-r--r-- 1 xw xw   520 Sep  8 03:49 你好.class
-rw-r--r-- 1 xw xw  1248 Sep  8 03:49 你好.jar
-rw-r--r-- 1 xw xw   118 Sep  8 03:49 你好.java
-rw-r--r-- 1 xw xw  4370 Sep  8 03:49 你好.mpl
-rw-r--r-- 1 xw xw   712 Sep  8 03:49 你好.mplt
-rw-r--r-- 1 xw xw     0 Sep  8 03:49 你好.VtableImpl.groots.txt
-rw-r--r-- 1 xw xw 17231 Sep  8 03:49 你好.VtableImpl.mpl
-rw-r--r-- 1 xw xw   142 Sep  8 03:49 你好.VtableImpl.primordials.txt
-rw-r--r-- 1 xw xw 30927 Sep  8 03:49 你好.VtableImpl.s
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;有兴趣的可以先研究下.&lt;/p&gt;</content><author><name></name></author><summary type="html">之前承蒙这位测试, 方舟编译器支持Java下的中文命名标识符: 跑不通的可参考Z乎的这篇文章，已找到一个可使测试用例编译通过的java-core库 · Issue #I11R87 · HarmonyOS/OpenArkCompiler - 码云 Gitee.com</summary></entry><entry><title type="html">手工翻译方舟编译器源码:尝试重命名标识符与文本</title><link href="http://localhost:4000/%E5%91%BD%E5%90%8D/%E6%96%B9%E8%88%9F%E7%BC%96%E8%AF%91%E5%99%A8/2019/09/08/%E6%89%8B%E5%B7%A5%E7%BF%BB%E8%AF%91%E6%96%B9%E8%88%9F%E7%BC%96%E8%AF%91%E5%99%A8%E6%BA%90%E7%A0%81-%E5%B0%9D%E8%AF%95%E9%87%8D%E5%91%BD%E5%90%8D%E6%A0%87%E8%AF%86%E7%AC%A6%E4%B8%8E%E6%96%87%E6%9C%AC.html" rel="alternate" type="text/html" title="手工翻译方舟编译器源码:尝试重命名标识符与文本" /><published>2019-09-08T00:00:00-07:00</published><updated>2019-09-08T00:00:00-07:00</updated><id>http://localhost:4000/%E5%91%BD%E5%90%8D/%E6%96%B9%E8%88%9F%E7%BC%96%E8%AF%91%E5%99%A8/2019/09/08/%E6%89%8B%E5%B7%A5%E7%BF%BB%E8%AF%91%E6%96%B9%E8%88%9F%E7%BC%96%E8%AF%91%E5%99%A8%E6%BA%90%E7%A0%81:%E5%B0%9D%E8%AF%95%E9%87%8D%E5%91%BD%E5%90%8D%E6%A0%87%E8%AF%86%E7%AC%A6%E4%B8%8E%E6%96%87%E6%9C%AC</id><content type="html" xml:base="http://localhost:4000/%E5%91%BD%E5%90%8D/%E6%96%B9%E8%88%9F%E7%BC%96%E8%AF%91%E5%99%A8/2019/09/08/%E6%89%8B%E5%B7%A5%E7%BF%BB%E8%AF%91%E6%96%B9%E8%88%9F%E7%BC%96%E8%AF%91%E5%99%A8%E6%BA%90%E7%A0%81-%E5%B0%9D%E8%AF%95%E9%87%8D%E5%91%BD%E5%90%8D%E6%A0%87%E8%AF%86%E7%AC%A6%E4%B8%8E%E6%96%87%E6%9C%AC.html">&lt;p&gt;&lt;img src=&quot;http://localhost:4000/assets/2019-09-06_ark%E5%B0%9D%E8%AF%95%E9%87%8D%E5%91%BD%E5%90%8D.png&quot; alt=&quot;2019-09-06_ark尝试重命名&quot; /&gt;&lt;/p&gt;

&lt;p&gt;参考: &lt;a href=&quot;https://zhuanlan.zhihu.com/p/81046562&quot;&gt;小乖他爹：方舟编译器学习笔记6 方舟开源目录简介&lt;/a&gt;, 先从&lt;code class=&quot;highlighter-rouge&quot;&gt;maple.cpp&lt;/code&gt;入口代码开始中文化(与前作&lt;a href=&quot;https://zhuanlan.zhihu.com/p/50726829&quot;&gt;手工翻译Vue.js源码:尝试重命名标识符与文本&lt;/a&gt;类似), 作为初步的可行性实验.&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://github.com/program-in-chinese/overview/issues/166#issuecomment-528321173&quot;&gt;之前&lt;/a&gt;以为编译输出文件在重命名标识符后不会有变化, 尝试后发现天真了. 于是现在仅检验是否能够编译通过.&lt;/p&gt;

&lt;p&gt;下面是中文化后的&lt;code class=&quot;highlighter-rouge&quot;&gt;src/maple_driver/src/maple.cpp&lt;/code&gt;代码:&lt;/p&gt;
&lt;div class=&quot;language-c highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;n&quot;&gt;using&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;namespace&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;maple&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;kt&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;err&quot;&gt;报错&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;err&quot;&gt;返回&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
  &lt;span class=&quot;k&quot;&gt;switch&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;err&quot;&gt;返回&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;case&lt;/span&gt; &lt;span class=&quot;err&quot;&gt;无误&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;case&lt;/span&gt; &lt;span class=&quot;err&quot;&gt;退出帮助&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
      &lt;span class=&quot;k&quot;&gt;break&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;case&lt;/span&gt; &lt;span class=&quot;err&quot;&gt;退出&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
      &lt;span class=&quot;err&quot;&gt;错误&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;err&quot;&gt;错误日志&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;因错误退出!&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
      &lt;span class=&quot;k&quot;&gt;break&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;case&lt;/span&gt; &lt;span class=&quot;err&quot;&gt;非法参数&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
      &lt;span class=&quot;err&quot;&gt;错误&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;err&quot;&gt;错误日志&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;非法参数!&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
      &lt;span class=&quot;k&quot;&gt;break&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;case&lt;/span&gt; &lt;span class=&quot;err&quot;&gt;初始化失败&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
      &lt;span class=&quot;err&quot;&gt;错误&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;err&quot;&gt;错误日志&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;初始化失败!&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
      &lt;span class=&quot;k&quot;&gt;break&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;case&lt;/span&gt; &lt;span class=&quot;err&quot;&gt;文件未找到&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
      &lt;span class=&quot;err&quot;&gt;错误&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;err&quot;&gt;错误日志&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;文件未找到!&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
      &lt;span class=&quot;k&quot;&gt;break&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;case&lt;/span&gt; &lt;span class=&quot;err&quot;&gt;工具未找到&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
      &lt;span class=&quot;err&quot;&gt;错误&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;err&quot;&gt;错误日志&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;工具未找到!&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
      &lt;span class=&quot;k&quot;&gt;break&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;case&lt;/span&gt; &lt;span class=&quot;err&quot;&gt;编译失败&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
      &lt;span class=&quot;err&quot;&gt;错误&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;err&quot;&gt;错误日志&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;编译失败!&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
      &lt;span class=&quot;k&quot;&gt;break&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;case&lt;/span&gt; &lt;span class=&quot;err&quot;&gt;未实现&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
      &lt;span class=&quot;err&quot;&gt;错误&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;err&quot;&gt;错误日志&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;未实现!&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
      &lt;span class=&quot;k&quot;&gt;break&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;default&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;:&lt;/span&gt;
      &lt;span class=&quot;k&quot;&gt;break&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
  &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;using&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;namespace&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;maple&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;

&lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;main&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;argc&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;char&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;**&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;argv&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
  &lt;span class=&quot;err&quot;&gt;选项类&lt;/span&gt; &lt;span class=&quot;err&quot;&gt;选项&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
  &lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;err&quot;&gt;返回&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;err&quot;&gt;选项&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;err&quot;&gt;分析&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;argc&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;argv&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
  &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;err&quot;&gt;返回&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;err&quot;&gt;错误码&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;::&lt;/span&gt;&lt;span class=&quot;err&quot;&gt;无误&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;err&quot;&gt;返回&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;err&quot;&gt;编译器工厂类&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;::&lt;/span&gt;&lt;span class=&quot;err&quot;&gt;取个例&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;().&lt;/span&gt;&lt;span class=&quot;err&quot;&gt;编译&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;err&quot;&gt;选项&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
  &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
  &lt;span class=&quot;err&quot;&gt;报错&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;err&quot;&gt;返回&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
  &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;err&quot;&gt;返回&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;可按原官方编译方法编译通过的完整源码在: &lt;a href=&quot;https://gitee.com/Program-in-Chinese/OpenArkCompiler&quot;&gt;中文编程/OpenArkCompiler&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;下面打算参考&lt;a href=&quot;https://www.zhihu.com/question/343431810/answer/808816079&quot;&gt;如何看待方舟编译器于 2019 年 8 月 31 日开源？&lt;/a&gt;, 先对编译到AnalysisResult的部分进行中文化.&lt;/p&gt;

&lt;p&gt;注: 开发环境 – Ubuntu 18.04, &lt;a href=&quot;https://blog.csdn.net/weixin_42445727/article/details/81270916&quot;&gt;中文输入法&lt;/a&gt;, VS Code &amp;amp; 微软C++插件(标识符重命名有时不靠谱, 如&lt;code class=&quot;highlighter-rouge&quot;&gt;return ret&lt;/code&gt;, 重命名&lt;code class=&quot;highlighter-rouge&quot;&gt;ret&lt;/code&gt;会影响&lt;code class=&quot;highlighter-rouge&quot;&gt;return&lt;/code&gt;)&lt;/p&gt;</content><author><name></name></author><summary type="html"></summary></entry><entry><title type="html">用JS Search实现客户端JSON内容索引和搜索</title><link href="http://localhost:4000/%E5%91%BD%E5%90%8D/api/2019/07/31/%E7%94%A8JS-Search%E5%AE%9E%E7%8E%B0%E5%AE%A2%E6%88%B7%E7%AB%AFJSON%E5%86%85%E5%AE%B9%E7%B4%A2%E5%BC%95%E5%92%8C%E6%90%9C%E7%B4%A2.html" rel="alternate" type="text/html" title="用JS Search实现客户端JSON内容索引和搜索" /><published>2019-07-31T00:00:00-07:00</published><updated>2019-07-31T00:00:00-07:00</updated><id>http://localhost:4000/%E5%91%BD%E5%90%8D/api/2019/07/31/%E7%94%A8JS%20Search%E5%AE%9E%E7%8E%B0%E5%AE%A2%E6%88%B7%E7%AB%AFJSON%E5%86%85%E5%AE%B9%E7%B4%A2%E5%BC%95%E5%92%8C%E6%90%9C%E7%B4%A2</id><content type="html" xml:base="http://localhost:4000/%E5%91%BD%E5%90%8D/api/2019/07/31/%E7%94%A8JS-Search%E5%AE%9E%E7%8E%B0%E5%AE%A2%E6%88%B7%E7%AB%AFJSON%E5%86%85%E5%AE%B9%E7%B4%A2%E5%BC%95%E5%92%8C%E6%90%9C%E7%B4%A2.html">&lt;p&gt;为快速实现一个中文API搜索原型(&lt;a href=&quot;https://github.com/program-in-chinese/overview/issues/165&quot;&gt;中文API文档浏览器 · Issue #165 · program-in-chinese/overview&lt;/a&gt;), 使用了&lt;a href=&quot;https://github.com/bvaughn/js-search&quot;&gt;JS Search库&lt;/a&gt;, 参考&lt;a href=&quot;http://bvaughn.github.io/js-search/&quot;&gt;JS Search演示&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;演示地址: &lt;a href=&quot;http://codeinchinese.com/API%E4%B8%AD%E6%96%87%E7%B4%A2%E5%BC%95/%E4%B8%BB%E9%A1%B5.html&quot;&gt;API搜索演示&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;演示:&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;http://localhost:4000/assets/2019-07-30_api%E6%90%9C%E7%B4%A2%E5%8E%9F%E5%9E%8B.gif&quot; alt=&quot;2019-07-30_api搜索原型&quot; /&gt;&lt;/p&gt;

&lt;p&gt;源码库: &lt;a href=&quot;https://github.com/program-in-chinese/team_website/tree/master/docs/API%E4%B8%AD%E6%96%87%E7%B4%A2%E5%BC%95&quot;&gt;program-in-chinese/team_website&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;部分JavaScript代码:&lt;/p&gt;
&lt;div class=&quot;language-javascript highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;kd&quot;&gt;var&lt;/span&gt; &lt;span class=&quot;err&quot;&gt;重建索引&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;kd&quot;&gt;function&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
  &lt;span class=&quot;err&quot;&gt;搜索&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;JsSearch&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;Search&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;'包'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;

  &lt;span class=&quot;err&quot;&gt;搜索&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;tokenizer&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;JsSearch&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;StopWordsTokenizer&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;err&quot;&gt;搜索&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;tokenizer&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
  &lt;span class=&quot;err&quot;&gt;搜索&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;indexStrategy&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;JsSearch&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;AllSubstringsIndexStrategy&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;();&lt;/span&gt;
  
  &lt;span class=&quot;err&quot;&gt;搜索&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;addIndex&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;'类'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
  &lt;span class=&quot;err&quot;&gt;搜索&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;addIndex&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;'名'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;

  &lt;span class=&quot;err&quot;&gt;搜索&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;addDocuments&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;err&quot;&gt;所有数据&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;};&lt;/span&gt;

&lt;span class=&quot;p&quot;&gt;...&lt;/span&gt;
&lt;span class=&quot;kd&quot;&gt;var&lt;/span&gt; &lt;span class=&quot;err&quot;&gt;进行搜索&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;kd&quot;&gt;function&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
  &lt;span class=&quot;kd&quot;&gt;var&lt;/span&gt; &lt;span class=&quot;err&quot;&gt;原始输入&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;err&quot;&gt;搜索框&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;value&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
  &lt;span class=&quot;kd&quot;&gt;var&lt;/span&gt; &lt;span class=&quot;err&quot;&gt;关键字&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;err&quot;&gt;原始输入&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
  &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;err&quot;&gt;中英词典&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;err&quot;&gt;原始输入&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;err&quot;&gt;关键字&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;err&quot;&gt;中英词典&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;err&quot;&gt;原始输入&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
  &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
  &lt;span class=&quot;err&quot;&gt;搜索结果&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;err&quot;&gt;搜索&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;search&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;err&quot;&gt;关键字&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
  &lt;span class=&quot;err&quot;&gt;更新显示&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;();&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;};&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;</content><author><name></name></author><summary type="html">为快速实现一个中文API搜索原型(中文API文档浏览器 · Issue #165 · program-in-chinese/overview), 使用了JS Search库, 参考JS Search演示</summary></entry><entry><title type="html">Django例程</title><link href="http://localhost:4000/2019/07/03/django%E4%BE%8B%E7%A8%8B.note" rel="alternate" type="text/html" title="Django例程" /><published>2019-07-03T00:00:00-07:00</published><updated>2019-07-03T00:00:00-07:00</updated><id>http://localhost:4000/2019/07/03/django%E4%BE%8B%E7%A8%8B</id><content type="html" xml:base="http://localhost:4000/2019/07/03/django%E4%BE%8B%E7%A8%8B.note">```
$ python3 manage.py runserver
Watching for file changes with StatReloader
Performing system checks...

System check identified no issues (0 silenced).

You have 17 unapplied migration(s). Your project may not work properly until you apply the migrations for app(s): admin, auth, contenttypes, sessions.
Run 'python manage.py migrate' to apply them.

July 03, 2019 - 18:18:18
Django version 2.2.3, using settings 'django_mysite.settings'
Starting development server at http://127.0.0.1:8000/
Quit the server with CONTROL-C.
```

```
$ python3 manage.py migrate
Operations to perform:
  Apply all migrations: admin, auth, contenttypes, sessions
Running migrations:
  Applying contenttypes.0001_initial... OK
  Applying auth.0001_initial... OK
  Applying admin.0001_initial... OK
  Applying admin.0002_logentry_remove_auto_add... OK
  Applying admin.0003_logentry_add_action_flag_choices... OK
  Applying contenttypes.0002_remove_content_type_name... OK
  Applying auth.0002_alter_permission_name_max_length... OK
  Applying auth.0003_alter_user_email_max_length... OK
  Applying auth.0004_alter_user_username_opts... OK
  Applying auth.0005_alter_user_last_login_null... OK
  Applying auth.0006_require_contenttypes_0002... OK
  Applying auth.0007_alter_validators_add_error_messages... OK
  Applying auth.0008_alter_user_username_max_length... OK
  Applying auth.0009_alter_user_last_name_max_length... OK
  Applying auth.0010_alter_group_name_max_length... OK
  Applying auth.0011_update_proxy_permissions... OK
  Applying sessions.0001_initial... OK
```

```
$ python3 manage.py makemigrations 投票
```
```
ModuleNotFoundError: No module named '投票.apps.投票Configdjango'; '投票.apps' is not a package
```
少了末尾的逗号:
```
    '投票.apps.投票Config'&lt;---这里
```
加上后:
```
$ python3 manage.py makemigrations 投票
Migrations for '投票':
  投票/migrations/0001_initial.py
    - Create model 问题
    - Create model 选项
$ python3 manage.py sqlmigrate 投票 0001
BEGIN;
--
-- Create model 问题
--
CREATE TABLE &quot;投票_问题&quot; (&quot;id&quot; integer NOT NULL PRIMARY KEY AUTOINCREMENT, &quot;内容&quot; varchar(200) NOT NULL, &quot;发问日期&quot; datetime NOT NULL);
--
-- Create model 选项
--
CREATE TABLE &quot;投票_选项&quot; (&quot;id&quot; integer NOT NULL PRIMARY KEY AUTOINCREMENT, &quot;内容&quot; varchar(200) NOT NULL, &quot;票数&quot; integer NOT NULL, &quot;问题_id&quot; integer NOT NULL REFERENCES &quot;投票_问题&quot; (&quot;id&quot;) DEFERRABLE INITIALLY DEFERRED);
CREATE INDEX &quot;投票_选项_问题_id_4c48b252&quot; ON &quot;投票_选项&quot; (&quot;问题_id&quot;);
COMMIT;
$ python3 manage.py migrate
Operations to perform:
  Apply all migrations: admin, auth, contenttypes, sessions, 投票
Running migrations:
  Applying 投票.0001_initial... OK
```

数据库API
```
$ python3 manage.py shell
Python 3.7.3 (v3.7.3:ef4ec6ed12, Mar 25 2019, 16:52:21) 
[Clang 6.0 (clang-600.0.57)] on darwin
Type &quot;help&quot;, &quot;copyright&quot;, &quot;credits&quot; or &quot;license&quot; for more information.
(InteractiveConsole)
&gt;&gt;&gt; from 投票.models import 选项, 问题
&gt;&gt;&gt; 问题.Objects.all()
Traceback (most recent call last):
  File &quot;&lt;console&gt;&quot;, line 1, in &lt;module&gt;
AttributeError: type object '问题' has no attribute 'Objects'
&gt;&gt;&gt; 问题.objects.all()
&lt;QuerySet []&gt;
&gt;&gt;&gt; from django.utils import timezone
&gt;&gt;&gt; 问 = 问题(内容=&quot;最近咋样?&quot;, 发问日期=timezone.now())
&gt;&gt;&gt; 问.save()
&gt;&gt;&gt; 问.id
1
&gt;&gt;&gt; 问.内容
'最近咋样?'
&gt;&gt;&gt; 问.发问日期
datetime.datetime(2019, 7, 3, 19, 8, 27, 215031, tzinfo=&lt;UTC&gt;)
&gt;&gt;&gt; 问.内容=&quot;最近可好?&quot;
&gt;&gt;&gt; 问.save()
&gt;&gt;&gt; 问题.objects.all()
&lt;QuerySet [&lt;问题: 问题 object (1)&gt;]&gt;
```

添加`刚发问`接口:
```
$ python3 manage.py shell
Python 3.7.3 (v3.7.3:ef4ec6ed12, Mar 25 2019, 16:52:21) 
[Clang 6.0 (clang-600.0.57)] on darwin
Type &quot;help&quot;, &quot;copyright&quot;, &quot;credits&quot; or &quot;license&quot; for more information.
(InteractiveConsole)
&gt;&gt;&gt; 问题.objects.all()
Traceback (most recent call last):
  File &quot;&lt;console&gt;&quot;, line 1, in &lt;module&gt;
NameError: name '问题' is not defined
&gt;&gt;&gt; from 投票.models import 选项, 问题
&gt;&gt;&gt; 问题.objects.all()
&lt;QuerySet [&lt;问题: 最近可好?&gt;]&gt;
&gt;&gt;&gt; 问题.objects.filter(id=1)
&lt;QuerySet [&lt;问题: 最近可好?&gt;]&gt;
&gt;&gt;&gt; 问题.objects.filter(内容__startswith='最')
&lt;QuerySet [&lt;问题: 最近可好?&gt;]&gt;
&gt;&gt;&gt; from django.utils import timezone
&gt;&gt;&gt; 今年=timezone.now().year
&gt;&gt;&gt; 
&gt;&gt;&gt; 问题.objects.get(发问日期__year=今年)
&lt;问题: 最近可好?&gt;
&gt;&gt;&gt; 问题.objects.get(id=2)
Traceback (most recent call last):
  File &quot;&lt;console&gt;&quot;, line 1, in &lt;module&gt;
  File &quot;/Library/Frameworks/Python.framework/Versions/3.7/lib/python3.7/site-packages/django/db/models/manager.py&quot;, line 82, in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
  File &quot;/Library/Frameworks/Python.framework/Versions/3.7/lib/python3.7/site-packages/django/db/models/query.py&quot;, line 408, in get
    self.model._meta.object_name
投票.models.问题.DoesNotExist: 问题 matching query does not exist.
&gt;&gt;&gt; 问问
&gt;&gt;&gt; 问=问题.objects.get(pk=1)
&gt;&gt;&gt; 问.刚发问()
True
&gt;&gt;&gt; 问.选项_set.all()
&lt;QuerySet []&gt;
&gt;&gt;&gt; 问.选项_set.create(内容='没啥', 票数=0)
&lt;选项: 没啥&gt;
&gt;&gt;&gt; 问.选项_set.create(内容='看天', 票数=0)
&lt;选项: 看天&gt;
&gt;&gt;&gt; 选选-问.选项_set.create(内容='打字', 数=0)
Traceback (most recent call last):
  File &quot;&lt;console&gt;&quot;, line 1, in &lt;module&gt;
NameError: name '选' is not defined
&gt;&gt;&gt; 选问问选项_set.create(内容='打字', 票数=0)
&gt;&gt;&gt; 选.问题
&lt;问题: 最近可好?&gt;
&gt;&gt;&gt; 问.选项_set.all()
&lt;QuerySet [&lt;选项: 没啥&gt;, &lt;选项: 看天&gt;, &lt;选项: 打字&gt;]&gt;
&gt;&gt;&gt; 问.选项_set.count()
3
&gt;&gt;&gt; 选项.objects.filter(问题__发问日期__year=今年)
&lt;QuerySet [&lt;选项: 没啥&gt;, &lt;选项: 看天&gt;, &lt;选项: 打字&gt;]&gt;
&gt;&gt;&gt; 选=问.选项_set.filter(内容__startswith='打')
&gt;&gt;&gt; 选.delete()
(1, {'投票.选项': 1})
&gt;&gt;&gt; 选项.objects.filter(问题__发问日期__year=今年)
&lt;QuerySet [&lt;选项: 没啥&gt;, &lt;选项: 看天&gt;]&gt;
```</content><author><name></name></author><summary type="html"></summary></entry><entry><title type="html">从立创EDA，Gratipay看中文编程开发环境和推广运营的一个趋势</title><link href="http://localhost:4000/%E5%B0%8F%E7%BB%93/2019/07/01/%E4%BB%8E%E7%AB%8B%E5%88%9BEDA-Gratipay%E7%9C%8B%E4%B8%AD%E6%96%87%E7%BC%96%E7%A8%8B%E5%BC%80%E5%8F%91%E7%8E%AF%E5%A2%83%E5%92%8C%E6%8E%A8%E5%B9%BF%E8%BF%90%E8%90%A5%E7%9A%84%E4%B8%80%E4%B8%AA%E8%B6%8B%E5%8A%BF.html" rel="alternate" type="text/html" title="从立创EDA，Gratipay看中文编程开发环境和推广运营的一个趋势" /><published>2019-07-01T00:00:00-07:00</published><updated>2019-07-01T00:00:00-07:00</updated><id>http://localhost:4000/%E5%B0%8F%E7%BB%93/2019/07/01/%E4%BB%8E%E7%AB%8B%E5%88%9BEDA,Gratipay%E7%9C%8B%E4%B8%AD%E6%96%87%E7%BC%96%E7%A8%8B%E5%BC%80%E5%8F%91%E7%8E%AF%E5%A2%83%E5%92%8C%E6%8E%A8%E5%B9%BF%E8%BF%90%E8%90%A5%E7%9A%84%E4%B8%80%E4%B8%AA%E8%B6%8B%E5%8A%BF</id><content type="html" xml:base="http://localhost:4000/%E5%B0%8F%E7%BB%93/2019/07/01/%E4%BB%8E%E7%AB%8B%E5%88%9BEDA-Gratipay%E7%9C%8B%E4%B8%AD%E6%96%87%E7%BC%96%E7%A8%8B%E5%BC%80%E5%8F%91%E7%8E%AF%E5%A2%83%E5%92%8C%E6%8E%A8%E5%B9%BF%E8%BF%90%E8%90%A5%E7%9A%84%E4%B8%80%E4%B8%AA%E8%B6%8B%E5%8A%BF.html">&lt;p&gt;前不久听说&lt;a href=&quot;https://zhuanlan.zhihu.com/p/32744735&quot;&gt;立创EDA&lt;/a&gt;，对比之前的讨论: &lt;a href=&quot;https://github.com/program-in-chinese/overview/issues/11&quot;&gt;适合中文用户的编程语言和IDE, 侧重于现有语言/IDE不具备的特性 · Issue #11 · program-in-chinese/overview&lt;/a&gt;，觉得颇有共鸣。&lt;/p&gt;

&lt;h3 id=&quot;库管理和共享&quot;&gt;库管理和共享&lt;/h3&gt;

&lt;p&gt;虽然EDA开发和传统软件开发看起来相去甚远，但一个很大的共通点是，硬件库和软件库的管理和共享。软件本来源于硬件，库自然也存在依赖关系，EDA中的元件库，类似于编程语言的标准库和第三方库。&lt;/p&gt;

&lt;p&gt;立创的开发环境集成了&lt;strong&gt;库管理和分享功能&lt;/strong&gt;，这是一个降低入门门槛、提高开发效率进而迅速积累人气的强大优势。&lt;/p&gt;

&lt;p&gt;现有的英文编程语言，多数是语言与IDE分离，在IDE中同时提供库管理加上开发者共享库功能的并不多见。&lt;/p&gt;

&lt;p&gt;– 7/3 补: 经指点，有类似紧密集成语言和库管理的例子，如微软.NET的&lt;a href=&quot;https://docs.microsoft.com/en-us/nuget/what-is-nuget&quot;&gt;NuGet&lt;/a&gt;也集成在了Visual Studio。个人认为也佐证这项功能的重要性。&lt;/p&gt;

&lt;p&gt;中文编程语言和开发环境，作为后起，需要利用各种加速积累人气的功能。&lt;strong&gt;库管理和分享功能看来是其中之一。&lt;/strong&gt;&lt;/p&gt;
&lt;h3 id=&quot;运营和筹款&quot;&gt;运营和筹款&lt;/h3&gt;

&lt;p&gt;这几天恰好得知一个开放项目在讨论筹资方式，觉得有些共通性，一并说说。&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://www.zhihu.com/question/27858574/answer/190813491&quot;&gt;几年前&lt;/a&gt;参与过一个很特别的项目Gratipay。它的理念是不仅代码开源，而且运营决策和财务都尽量在公开平台进行。它自身的产品就是一个众筹平台，而且筹款主要通过自己的平台进行。这个公司由于种种原因未能延续，但经验教训可供借鉴。&lt;/p&gt;

&lt;p&gt;它的创始人最后写的回顾文章在&lt;a href=&quot;https://gratipay.news/the-end-cbfba8f50981&quot;&gt;这里&lt;/a&gt;。注意它是曾经有过指数增长期的，但2015年有断崖事故，具体可以自行了解。下面只是我参与后的一些状况。&lt;/p&gt;

&lt;p&gt;主要参与的是财务方面，包括预算清理、收支数据整理和可视化等等。在2016年末刚参与时，就想首先了解财务状况。账面余额之外，还需要了解支出的细节，包括办公地点租金、使用第三方服务的开销等等。于是开始了持续了几个月的&lt;a href=&quot;https://github.com/gratipay/inside.gratipay.com/issues/928&quot;&gt;整理和优化&lt;/a&gt;。由于都是通过网络联系，各地的参与者意见整合都使这个过程更久。下面是一些节流效果：&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;有些第三方服务并不属于必需，或者只需基本功能（更便宜的月费）&lt;/li&gt;
  &lt;li&gt;有些服务对开源项目有特别照顾，由于Gratipay的开源性质和历史，往往这些服务都很快通过了免费请求的申请。期间还提出了一个对这些提供”资助“的对开源项目友好的服务商&lt;a href=&quot;https://github.com/gratipay/inside.gratipay.com/issues/950&quot;&gt;进行推介的想法&lt;/a&gt;，可惜没有成型。&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;省下的经费，一部分投入了其他更需要的服务，或者对其他服务进行捐款（比如&lt;a href=&quot;https://github.com/gratipay/inside.gratipay.com/issues/928#issuecomment-285506054&quot;&gt;Read the Docs&lt;/a&gt;)。&lt;/p&gt;

&lt;p&gt;在收支数据方面，主要是通过一个基于文本的会计软件BeanCount进行了尝试：&lt;a href=&quot;https://github.com/gratipay/finances/pull/35&quot;&gt;Port to Beancount by chadwhitacre · Pull Request #35 · gratipay/finances&lt;/a&gt;。&lt;/p&gt;

&lt;p&gt;简单说说在预算和收支方面的个人体会：&lt;/p&gt;

&lt;ol&gt;
  &lt;li&gt;公开平台讨论运营当然有好处，但副效应就是人多嘴杂，能够干实事的在任何时候都是少数。&lt;/li&gt;
  &lt;li&gt;开源项目加开放运营，已经够另类和边缘。这种情况下，需要争取任何可以争取的资源，开源节流必须都要抓。很难想象这个项目开始了四年之久但除了报税之外没有非常规整的流水和定期的预算审核。&lt;/li&gt;
  &lt;li&gt;财务数据虽然一直打算公开，但一直没有合适的软件进行可视化，也没有与主网站进行整合，导致财务透明这一项本来非常独特也很有区别度的产品/企业特色没有起到应有的作用。&lt;/li&gt;
  &lt;li&gt;在筹款方面，单一倚靠众筹。原本的思路是，Gratipay这个众筹平台可供所有开源项目的作者进行众筹，而Gratipay平台本身也是自己的客户。但这就导致，收入完全依赖于众筹平台本身的推广程度。而开源项目毕竟是小众，相对于其他的众筹平台，总用户和捐款数完全不在一个数量级。创始人希望从这其中通过完全平等的身份分得一部分，而不是使用类似”收税“的方式，这也有很大的不确定性。&lt;/li&gt;
  &lt;li&gt;多数项目参与者都是志愿者，由于每周仅有几百美元众筹收入，除了维持服务之外，几乎没有盈余。所以多数人很长时间内都只是非常象征性的拿些”咖啡钱“，包括主创。收入分配方面，话就长了（也是一个独特之处），以后可以另说。&lt;/li&gt;
&lt;/ol&gt;

&lt;p&gt;说回立创，对比上面第四点，通过免费版积攒巨大的用户基础，通过收费版本提供更多专业服务。一方面给出了非常明确的”为什么花这钱“的理由，另一方面收费版是通过按人/天收费，给了足够付费灵活度，更关键的是有了相对稳定的收入流（毕竟这月缴费下个月停缴的是少数）。&lt;/p&gt;

&lt;p&gt;再说说1-3点，下面想哪说哪。&lt;/p&gt;

&lt;p&gt;一旦选择公开运营，就要准备好应对各种不同声音，尤其是牵涉到资金使用的问题。最好一开始就建立一套比较合规的会计流程，为定期讨论预算、收支等等提供基础。&lt;/p&gt;

&lt;p&gt;通过网络的合作有很大的延迟，各种讨论经常是等你一天，等他一天，一会就是几周过去。这对项目进度管控是很大的考验。&lt;/p&gt;

&lt;p&gt;在GitHub这样的平台讨论有一个好处，就是随时可以@到各种相关服务/工具的开发者。比如在用Beancount的时候，就拉进了它的原作者作为顾问。这样的平台很助力交流。&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;开源/开放项目的最大优势，在于项目透明度&lt;/strong&gt;，以及由此形成的相比其他平台更稳固的用户基础（因为有更高的信任度）。上面的收支情况如果公开，也可以进一步增加透明度，因此最好尽可能利用这一优势，比如把收支、盈亏情况在主页进行公示，提供链接了解更多细节等等。&lt;/p&gt;

&lt;p&gt;团队都是志愿者的情况下，大家往往图的都不是钱（至少不是眼前的钱）。那么如何激励参与呢？包括原本的团队成员，也需要持续的动力。个人认为，一个“成果单”可以提供非物质激励，比如每月写出团队各人对项目进展的贡献（甚至包括一些代码链接）。对个人来说，可以看到一路以来对项目的投入；对其他人（包括外人）来说，也可以了解团队中其他人都在做什么。有一定影响之后，甚至可以通过公开招聘一些暑假实习生，好处是，他们的贡献都可以直接体现在这份成果单中。而成果单的公开透明也可以保证相对公正。&lt;/p&gt;

&lt;p&gt;内部团队建设之外，与合作的第三方联系很重要。尤其是上下游合作者和服务提供商（尤其是提供了某种程度资助的），有条件的话应该借助自身平台和影响力，有忙就帮（包括在网站进行某种感谢/公示），尽量扩大企业/实体层面的朋友圈。&lt;/p&gt;

&lt;p&gt;开源和开放，对于中文编程语言和开发环境来说，现在看来是必由之路。上面的经验教训，希望对来者有所裨益。&lt;/p&gt;</content><author><name></name></author><summary type="html">前不久听说立创EDA，对比之前的讨论: 适合中文用户的编程语言和IDE, 侧重于现有语言/IDE不具备的特性 · Issue #11 · program-in-chinese/overview，觉得颇有共鸣。</summary></entry></feed>